# Alert Bot Database Environment Configuration
# Copy this file to .env and update the values according to your environment

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
NODE_ENV=development
ENVIRONMENT=dev

# =============================================================================
# MONGODB CONFIGURATION
# =============================================================================

# MongoDB Connection
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_DATABASE=alert_bot_dev

# MongoDB Authentication
MONGO_ROOT_USERNAME=admin
MONGO_ROOT_PASSWORD=admin123
MONGO_AUTH_DB=admin

# MongoDB Connection String (alternative to individual settings)
# MONGO_URI=mongodb://admin:admin123@localhost:27017/alert_bot_dev?authSource=admin

# MongoDB Options
MONGO_MAX_POOL_SIZE=10
MONGO_MIN_POOL_SIZE=2
MONGO_MAX_IDLE_TIME=30000
MONGO_SERVER_SELECTION_TIMEOUT=5000
MONGO_SOCKET_TIMEOUT=45000
MONGO_CONNECT_TIMEOUT=10000
MONGO_HEARTBEAT_FREQUENCY=10000

# MongoDB Replica Set (for production)
# MONGO_REPLICA_SET=rs0
# MONGO_READ_PREFERENCE=primary
# MONGO_WRITE_CONCERN=majority

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Connection String (alternative to individual settings)
# REDIS_URL=redis://localhost:6379/0

# Redis Options
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_FAMILY=4
REDIS_KEEP_ALIVE=30000

# Redis Cluster (for production)
# REDIS_CLUSTER_ENABLED=false
# REDIS_CLUSTER_NODES=redis1:6379,redis2:6379,redis3:6379

# Redis Sentinel (for high availability)
# REDIS_SENTINEL_ENABLED=false
# REDIS_SENTINEL_MASTER_NAME=mymaster
# REDIS_SENTINEL_NODES=sentinel1:26379,sentinel2:26379,sentinel3:26379

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Backup Settings
BACKUP_DIR=./backups
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
COMPRESS=true
ENCRYPT=false
ENCRYPTION_KEY=

# Backup Storage (optional)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_S3_BUCKET=
# AWS_S3_REGION=us-east-1

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Database Monitoring
DB_MONITORING_ENABLED=true
DB_MONITORING_INTERVAL=30000
DB_SLOW_QUERY_THRESHOLD=1000

# Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=./logs/database.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# =============================================================================
# ADMIN INTERFACES
# =============================================================================

# MongoDB Express (Web UI for MongoDB)
MONGO_EXPRESS_PORT=8081
MONGO_EXPRESS_USERNAME=admin
MONGO_EXPRESS_PASSWORD=admin123

# Redis Commander (Web UI for Redis)
REDIS_COMMANDER_PORT=8082
REDIS_COMMANDER_USERNAME=admin
REDIS_COMMANDER_PASSWORD=admin123

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Slack Notifications
SLACK_WEBHOOK=
SLACK_CHANNEL=#alerts

# Email Notifications
EMAIL_RECIPIENT=
SMTP_SERVER=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_SECURE=true

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Database Security
DB_SSL_ENABLED=false
DB_SSL_CERT_PATH=
DB_SSL_KEY_PATH=
DB_SSL_CA_PATH=

# Access Control
DB_IP_WHITELIST=127.0.0.1,::1
DB_MAX_CONNECTIONS=100
DB_CONNECTION_TIMEOUT=30000

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# MongoDB Performance
MONGO_BUFFER_MAX_ENTRIES=16
MONGO_USE_UNIFIED_TOPOLOGY=true
MONGO_USE_NEW_URL_PARSER=true
MONGO_AUTO_INDEX=true
MONGO_AUTO_CREATE=true

# Redis Performance
REDIS_MAX_MEMORY=512mb
REDIS_MAX_MEMORY_POLICY=allkeys-lru
REDIS_LAZY_FREEING=true
REDIS_IO_THREADS=4
REDIS_IO_THREADS_DO_READS=true

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development Options
DEV_SEED_DATABASE=true
DEV_RESET_ON_START=false
DEV_ENABLE_DEBUG=true
DEV_MOCK_DATA=false

# Testing Options
TEST_DATABASE_SUFFIX=_test
TEST_PARALLEL_JOBS=4
TEST_TIMEOUT=30000

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker Network
DOCKER_NETWORK=alert_bot_network
DOCKER_SUBNET=172.20.0.0/16
DOCKER_GATEWAY=172.20.0.1

# Docker Volumes
DOCKER_MONGO_DATA_PATH=./data/mongodb
DOCKER_MONGO_CONFIG_PATH=./data/mongodb-config
DOCKER_REDIS_DATA_PATH=./data/redis
DOCKER_LOGS_PATH=./logs

# Docker Compose Profiles
DOCKER_PROFILES=dev,debug

# =============================================================================
# HEALTH CHECK SETTINGS
# =============================================================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40

# Database Health Thresholds
MONGO_HEALTH_MAX_RESPONSE_TIME=1000
REDIS_HEALTH_MAX_RESPONSE_TIME=100
MONGO_HEALTH_MAX_CONNECTIONS=80
REDIS_HEALTH_MAX_MEMORY_USAGE=90

# =============================================================================
# MIGRATION SETTINGS
# =============================================================================

# Database Migration
MIGRATION_ENABLED=true
MIGRATION_AUTO_RUN=false
MIGRATION_COLLECTION=migrations
MIGRATION_LOCK_TIMEOUT=600000

# Schema Validation
SCHEMA_VALIDATION_ENABLED=true
SCHEMA_VALIDATION_LEVEL=strict
SCHEMA_VALIDATION_ACTION=error

# =============================================================================
# CACHE SETTINGS
# =============================================================================

# Cache Configuration
CACHE_TTL_DEFAULT=300
CACHE_TTL_MARKET_DATA=60
CACHE_TTL_USER_SESSION=3600
CACHE_TTL_API_RESPONSE=120
CACHE_TTL_RATE_LIMIT=900

# Cache Prefixes
CACHE_PREFIX_MARKET=market:
CACHE_PREFIX_USER=user:
CACHE_PREFIX_SESSION=session:
CACHE_PREFIX_RATE_LIMIT=rate_limit:
CACHE_PREFIX_NOTIFICATION=notification:

# =============================================================================
# QUEUE SETTINGS
# =============================================================================

# Queue Configuration
QUEUE_ENABLED=true
QUEUE_CONCURRENCY=5
QUEUE_MAX_ATTEMPTS=3
QUEUE_BACKOFF_DELAY=5000
QUEUE_REMOVE_ON_COMPLETE=100
QUEUE_REMOVE_ON_FAIL=50

# Queue Names
QUEUE_ALERTS=alerts
QUEUE_NOTIFICATIONS=notifications
QUEUE_MARKET_DATA=market_data
QUEUE_EMAIL=email
QUEUE_WEBHOOK=webhook

# =============================================================================
# METRICS AND ANALYTICS
# =============================================================================

# Metrics Collection
METRICS_ENABLED=true
METRICS_INTERVAL=60000
METRICS_RETENTION_DAYS=30

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_BATCH_SIZE=100
ANALYTICS_FLUSH_INTERVAL=30000

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature Toggles
FEATURE_USER_REGISTRATION=true
FEATURE_ALERT_CREATION=true
FEATURE_MARKET_DATA_UPDATES=true
FEATURE_NOTIFICATIONS=true
FEATURE_WEBHOOKS=true
FEATURE_API_ACCESS=true
FEATURE_TECHNICAL_ANALYSIS=true
FEATURE_ADVANCED_ALERTS=true
FEATURE_BULK_OPERATIONS=true
FEATURE_EXPORT_DATA=true

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate Limit Configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# Rate Limit by User Type
RATE_LIMIT_FREE_USER=100
RATE_LIMIT_BASIC_USER=500
RATE_LIMIT_PRO_USER=2000
RATE_LIMIT_PREMIUM_USER=10000

# =============================================================================
# CIRCUIT BREAKER
# =============================================================================

# Circuit Breaker Configuration
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT=60000
CIRCUIT_BREAKER_RESET_TIMEOUT=30000

# =============================================================================
# TIMEZONE AND LOCALIZATION
# =============================================================================

# Timezone Settings
TIMEZONE=UTC
DATE_FORMAT=YYYY-MM-DD HH:mm:ss
LOCALE=en-US

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# External API Configuration
EXTERNAL_API_TIMEOUT=30000
EXTERNAL_API_RETRIES=3
EXTERNAL_API_RETRY_DELAY=1000

# Market Data Providers
BINANCE_API_KEY=
BINANCE_API_SECRET=
COINGECKO_API_KEY=
ALPHA_VANTAGE_API_KEY=

# =============================================================================
# MAINTENANCE MODE
# =============================================================================

# Maintenance Configuration
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=System is under maintenance. Please try again later.
MAINTENANCE_ALLOWED_IPS=127.0.0.1,::1
MAINTENANCE_BYPASS_KEY=