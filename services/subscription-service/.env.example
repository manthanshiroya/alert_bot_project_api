# =============================================================================
# SUBSCRIPTION SERVICE ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and update the values according to your environment

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
NODE_ENV=development
HOST=0.0.0.0
SUBSCRIPTION_SERVICE_PORT=3002
PORT=3002

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017/alert_bot_subscription
MONGODB_DB_NAME=alert_bot_subscription
MONGODB_OPTIONS={"useNewUrlParser":true,"useUnifiedTopology":true}

# Database Connection Pool
MONGODB_MAX_POOL_SIZE=10
MONGODB_MIN_POOL_SIZE=5
MONGODB_MAX_IDLE_TIME=30000
MONGODB_SERVER_SELECTION_TIMEOUT=5000
MONGODB_SOCKET_TIMEOUT=45000
MONGODB_CONNECT_TIMEOUT=10000

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=1
REDIS_KEY_PREFIX=subscription:
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_RETRY_DELAY_ON_FAILURE=100
REDIS_MAX_RETRY_DELAY=3000
REDIS_MAX_RETRIES=3

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=alert-bot-subscription-service
JWT_AUDIENCE=alert-bot-users

# Password Hashing
BCRYPT_SALT_ROUNDS=12

# API Keys
API_KEY_SECRET=your-api-key-secret-change-this-in-production
INTERNAL_API_KEY=your-internal-api-key-for-service-communication

# Session Configuration
SESSION_SECRET=your-session-secret-change-this-in-production
SESSION_MAX_AGE=86400000
SESSION_SECURE=false
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=lax

# =============================================================================
# PAYMENT GATEWAY CONFIGURATION
# =============================================================================
# Stripe Configuration
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_WEBHOOK_SECRET=whsec_your_stripe_webhook_secret
STRIPE_API_VERSION=2023-10-16
STRIPE_CONNECT_WEBHOOK_SECRET=whsec_your_stripe_connect_webhook_secret

# PayPal Configuration
PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_CLIENT_SECRET=your_paypal_client_secret
PAYPAL_MODE=sandbox
PAYPAL_WEBHOOK_ID=your_paypal_webhook_id
PAYPAL_WEBHOOK_SECRET=your_paypal_webhook_secret

# =============================================================================
# EMAIL CONFIGURATION
# =============================================================================
# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM_NAME=Alert Bot
SMTP_FROM_EMAIL=noreply@alertbot.com

# Email Templates
EMAIL_TEMPLATE_DIR=./templates/email
EMAIL_TEMPLATE_ENGINE=handlebars

# =============================================================================
# SMS CONFIGURATION (TWILIO)
# =============================================================================
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890
TWILIO_VERIFY_SERVICE_SID=your_twilio_verify_service_sid

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
UPLOAD_DIR=./uploads
UPLOAD_MAX_SIZE=10485760
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,application/pdf
UPLOAD_TEMP_DIR=./temp

# Avatar Configuration
AVATAR_MAX_SIZE=2097152
AVATAR_ALLOWED_TYPES=image/jpeg,image/png,image/gif
AVATAR_RESIZE_WIDTH=200
AVATAR_RESIZE_HEIGHT=200
AVATAR_QUALITY=80

# =============================================================================
# CORS CONFIGURATION
# =============================================================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:8080
API_GATEWAY_URL=http://localhost:3000

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# Webhook Rate Limiting
WEBHOOK_RATE_LIMIT_WINDOW_MS=60000
WEBHOOK_RATE_LIMIT_MAX_REQUESTS=50

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_DIR=./logs
LOG_MAX_SIZE=10m
LOG_MAX_FILES=14d
LOG_DATE_PATTERN=YYYY-MM-DD

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================
CACHE_TTL=3600
CACHE_MAX_KEYS=1000
CACHE_CHECK_PERIOD=600

# Plan Cache
PLAN_CACHE_TTL=1800
PLAN_COMPARISON_CACHE_TTL=3600

# User Cache
USER_CACHE_TTL=900
USER_SESSION_CACHE_TTL=1800

# Report Cache
REPORT_CACHE_TTL=7200
REPORT_SCHEDULE_CACHE_TTL=3600

# =============================================================================
# SUBSCRIPTION CONFIGURATION
# =============================================================================
# Trial Configuration
DEFAULT_TRIAL_DAYS=14
MAX_TRIAL_EXTENSIONS=1
TRIAL_EXTENSION_DAYS=7

# Grace Period
GRACE_PERIOD_DAYS=3
SUSPENSION_GRACE_DAYS=7
CANCELLATION_GRACE_DAYS=30

# Usage Limits
DEFAULT_ALERT_LIMIT=100
DEFAULT_API_CALL_LIMIT=1000
DEFAULT_WEBHOOK_LIMIT=500
DEFAULT_STORAGE_LIMIT=1073741824

# Billing
BILLING_CYCLE_ANCHOR_DAY=1
INVOICE_DUE_DAYS=7
LATE_FEE_PERCENTAGE=5
CURRENCY_DEFAULT=USD

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Subscription Notifications
NOTIFY_TRIAL_ENDING_DAYS=3
NOTIFY_PAYMENT_FAILED_ATTEMPTS=3
NOTIFY_USAGE_WARNING_PERCENTAGE=80
NOTIFY_USAGE_LIMIT_PERCENTAGE=95

# Email Notification Settings
EMAIL_QUEUE_DELAY=5000
EMAIL_RETRY_ATTEMPTS=3
EMAIL_RETRY_DELAY=30000

# SMS Notification Settings
SMS_QUEUE_DELAY=2000
SMS_RETRY_ATTEMPTS=2
SMS_RETRY_DELAY=15000

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================
WEBHOOK_TIMEOUT=30000
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_RETRY_DELAY=5000
WEBHOOK_MAX_PAYLOAD_SIZE=1048576

# Webhook Signature Verification
WEBHOOK_SIGNATURE_TOLERANCE=300
WEBHOOK_VERIFY_SSL=true

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================
# Health Check
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# APM (Application Performance Monitoring)
NEW_RELIC_LICENSE_KEY=your_new_relic_license_key
NEW_RELIC_APP_NAME=alert-bot-subscription-service
NEW_RELIC_ENABLED=false

# Elastic APM
ELASTIC_APM_SERVER_URL=http://localhost:8200
ELASTIC_APM_SECRET_TOKEN=your_elastic_apm_secret_token
ELASTIC_APM_SERVICE_NAME=subscription-service
ELASTIC_APM_ENVIRONMENT=development
ELASTIC_APM_ENABLED=false

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_PLAN_COMPARISON=true
FEATURE_USAGE_ANALYTICS=true
FEATURE_ADVANCED_BILLING=true
FEATURE_MULTI_CURRENCY=false
FEATURE_TAX_CALCULATION=false
FEATURE_DUNNING_MANAGEMENT=true
FEATURE_SUBSCRIPTION_PAUSE=true
FEATURE_PRORATION=true
FEATURE_COUPONS=true
FEATURE_REFERRALS=false

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
# Development Mode
DEVELOPMENT_MODE=true
DEBUG_ENABLED=true
VERBOSE_LOGGING=false

# Testing
TEST_DATABASE_URI=mongodb://localhost:27017/alert_bot_subscription_test
TEST_REDIS_DB=15
TEST_TIMEOUT=30000

# Mock Services
MOCK_PAYMENT_GATEWAY=false
MOCK_EMAIL_SERVICE=false
MOCK_SMS_SERVICE=false

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================
# API Gateway
API_GATEWAY_BASE_URL=http://localhost:3000
API_GATEWAY_TIMEOUT=10000

# User Service
USER_SERVICE_BASE_URL=http://localhost:3001
USER_SERVICE_TIMEOUT=5000

# Telegram Service
TELEGRAM_SERVICE_BASE_URL=http://localhost:3003
TELEGRAM_SERVICE_TIMEOUT=5000

# Alert Engine Service
ALERT_ENGINE_BASE_URL=http://localhost:3004
ALERT_ENGINE_TIMEOUT=5000

# =============================================================================
# SECURITY HEADERS
# =============================================================================
SECURITY_HSTS_MAX_AGE=31536000
SECURITY_HSTS_INCLUDE_SUBDOMAINS=true
SECURITY_HSTS_PRELOAD=true
SECURITY_CONTENT_TYPE_NO_SNIFF=true
SECURITY_FRAME_OPTIONS=DENY
SECURITY_XSS_PROTECTION=1; mode=block
SECURITY_REFERRER_POLICY=strict-origin-when-cross-origin

# =============================================================================
# MISCELLANEOUS
# =============================================================================
# Timezone
TIMEZONE=UTC
DATE_FORMAT=YYYY-MM-DD HH:mm:ss

# Pagination
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# Request Timeout
REQUEST_TIMEOUT=30000

# File Processing
FILE_PROCESSING_TIMEOUT=60000
FILE_PROCESSING_MAX_CONCURRENT=5

# Report Generation
REPORT_GENERATION_TIMEOUT=300000
REPORT_MAX_RECORDS=100000
REPORT_BATCH_SIZE=1000

# Cleanup Jobs
CLEANUP_EXPIRED_SESSIONS_INTERVAL=3600000
CLEANUP_OLD_LOGS_INTERVAL=86400000
CLEANUP_TEMP_FILES_INTERVAL=1800000

# =============================================================================
# END OF CONFIGURATION
# =============================================================================